<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Staff Management - Nescafe Hub</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    .font-poppins { font-family: 'Poppins', sans-serif; }
    .modal { display: none; }
    .modal.active { display: flex; }
    .fade-in { animation: fadeIn 0.3s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .employee-card {
      transition: all 0.3s ease;
      transform: translateY(0);
    }
    .employee-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body class="font-poppins bg-gray-100">
  <div class="flex h-screen overflow-hidden">
    <!-- Sidebar -->
    <div class="sidebar bg-gray-900 text-white w-64 flex-shrink-0 flex flex-col">
      <div class="p-4 flex items-center justify-between border-b border-gray-800">
        <div class="flex items-center">
          <i class="fas fa-coffee text-yellow-400 text-2xl mr-3"></i>
          <span class="logo-text text-xl font-bold">Nescafe Admin</span>
        </div>
        <button class="menu-toggle text-gray-400 hover:text-white focus:outline-none">
          <i class="fas fa-chevron-left"></i>
        </button>
      </div>
      
      <div class="flex-1 overflow-y-auto py-4">
        <nav>
          <ul class="space-y-1 px-2">
            <li>
              <a href="../admin/index.html" class="flex items-center p-3 rounded-lg hover:bg-gray-800 transition active-nav">
                <i class="fas fa-tachometer-alt text-yellow-400 w-6 text-center"></i>
                <span class="nav-text ml-3 text-yellow-400">Dashboard</span>
              </a>
            </li>
            <li>
              <a href="../admin/menu-management.html" class="flex items-center p-3 rounded-lg hover:bg-gray-800 transition">
                <i class="fas fa-utensils text-gray-400 w-6 text-center"></i>
                <span class="nav-text ml-3">Menu Management</span>
              </a>
            </li>
            <li>
              <a href="../admin/stock-management.html" class="flex items-center p-3 rounded-lg hover:bg-gray-800 transition">
                <i class="fas fa-boxes text-gray-400 w-6 text-center"></i>
                <span class="nav-text ml-3">Stock Management</span>
              </a>
            </li>
            <li>
              <a href="../admin/order-management.html" class="flex items-center p-3 rounded-lg hover:bg-gray-800 transition">
                <i class="fas fa-shopping-cart text-gray-400 w-6 text-center"></i>
                <span class="nav-text ml-3">Orders</span>
              </a>
            </li>
            <li>
              <a href="../admin/staff-management.html" class="flex items-center p-3 rounded-lg hover:bg-gray-800 transition">
                <i class="fas fa-users text-gray-400 w-6 text-center"></i>
                <span class="nav-text ml-3">Staff Management</span>
              </a>
            </li>
            <li>
              <a href="../admin/reports-management.html" class="flex items-center p-3 rounded-lg hover:bg-gray-800 transition">
                <i class="fas fa-chart-bar text-gray-400 w-6 text-center"></i>
                <span class="nav-text ml-3">Reports</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>
      
      <div class="p-4 border-t border-gray-800">
        <div class="flex items-center">
          <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Admin" class="w-10 h-10 rounded-full">
          <div class="ml-3 nav-text">
            <div class="font-medium">Admin User</div>
            <div class="text-sm text-gray-400">Super Admin</div>
          </div>
        </div>
        <a href="auth.html" class="mt-4 flex items-center text-gray-400 hover:text-white transition">
          <i class="fas fa-sign-out-alt w-6 text-center"></i>
          <span class="nav-text ml-3">Logout</span>
        </a>
      </div>
    </div>
    
    <!-- Main Content -->
    <div class="content flex-1 flex flex-col overflow-hidden">
      <!-- Top Navigation -->
      <header class="bg-white shadow-sm py-4 px-6 flex items-center justify-between">
        <h1 class="text-2xl font-bold text-gray-800">Staff Management</h1>
        <div class="flex items-center space-x-4">
          <div class="relative">
            <input type="text" id="searchInput" placeholder="Search staff..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent">
            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
          </div>
          <button class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg transition">
            <i class="fas fa-bell"></i>
          </button>
        </div>
      </header>
      
      <!-- Staff Management Content -->
      <main class="flex-1 overflow-y-auto p-6 bg-gray-50">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold text-gray-800">Team Members</h2>
          <div class="flex space-x-2">
            <button onclick="exportStaffData()" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg transition flex items-center">
              <i class="fas fa-file-export mr-2"></i> Export
            </button>
            <button onclick="openAddModal()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg transition flex items-center">
              <i class="fas fa-user-plus mr-2"></i> Add Staff
            </button>
          </div>
        </div>

        <!-- Stats Dashboard -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <div class="flex items-center">
              <div class="p-2 bg-blue-100 rounded-lg">
                <i class="fas fa-users text-blue-600"></i>
              </div>
              <div class="ml-3">
                <p class="text-sm text-gray-600">Total Staff</p>
                <p class="text-xl font-bold" id="totalStaff">0</p>
              </div>
            </div>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <div class="flex items-center">
              <div class="p-2 bg-green-100 rounded-lg">
                <i class="fas fa-user-check text-green-600"></i>
              </div>
              <div class="ml-3">
                <p class="text-sm text-gray-600">Active</p>
                <p class="text-xl font-bold text-green-600" id="activeStaff">0</p>
              </div>
            </div>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <div class="flex items-center">
              <div class="p-2 bg-yellow-100 rounded-lg">
                <i class="fas fa-clock text-yellow-600"></i>
              </div>
              <div class="ml-3">
                <p class="text-sm text-gray-600">On Shift</p>
                <p class="text-xl font-bold" id="onShiftStaff">0</p>
              </div>
            </div>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-sm">
            <select id="departmentFilter" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
              <option value="">All Departments</option>
            </select>
          </div>
        </div>

        <!-- View Toggle -->
        <div class="flex justify-between items-center mb-4">
          <div class="flex bg-gray-200 rounded-lg p-1">
            <button id="cardViewBtn" onclick="switchView('card')" class="px-4 py-2 rounded-md bg-white shadow-sm text-sm font-medium">
              <i class="fas fa-th-large mr-2"></i>Card View
            </button>
            <button id="tableViewBtn" onclick="switchView('table')" class="px-4 py-2 rounded-md text-sm font-medium text-gray-600">
              <i class="fas fa-list mr-2"></i>Table View
            </button>
          </div>
          <div class="flex items-center space-x-2">
            <span class="text-sm text-gray-600">Sort by:</span>
            <select id="sortBy" onchange="sortStaff()" class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
              <option value="name">Name</option>
              <option value="department">Department</option>
              <option value="hireDate">Hire Date</option>
              <option value="salary">Salary</option>
            </select>
          </div>
        </div>
        
        <!-- Card View -->
        <div id="cardView" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Staff cards will be loaded here -->
        </div>

        <!-- Table View -->
        <div id="tableView" class="bg-white rounded-xl shadow-sm overflow-hidden" style="display: none;">
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Employee</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Position</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Department</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Hire Date</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Salary</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-gray-200" id="staff-table">
                <!-- Staff table rows will be loaded here -->
              </tbody>
            </table>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- Add/Edit Modal -->
  <div id="staffModal" class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-50">
    <div class="bg-white rounded-xl p-6 w-full max-w-2xl mx-4 fade-in max-h-screen overflow-y-auto">
      <div class="flex justify-between items-center mb-4">
        <h3 id="modalTitle" class="text-xl font-bold text-gray-800">Add New Staff Member</h3>
        <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <form id="staffForm" onsubmit="handleSubmit(event)">
        <input type="hidden" id="editId" value="">
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
            <input type="text" id="firstName" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
            <input type="text" id="lastName" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
            <input type="email" id="email" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
            <input type="tel" id="phone" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Position</label>
            <input type="text" id="position" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Department</label>
            <select id="department" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
              <option value="">Select Department</option>
              <option value="Kitchen">Kitchen</option>
              <option value="Service">Service</option>
              <option value="Management">Management</option>
              <option value="Barista">Barista</option>
              <option value="Cashier">Cashier</option>
              <option value="Maintenance">Maintenance</option>
            </select>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Hire Date</label>
            <input type="date" id="hireDate" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Salary (RM)</label>
            <input type="number" id="salary" required min="0" step="0.01" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Shift</label>
            <select id="shift" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
              <option value="">Select Shift</option>
              <option value="Morning">Morning (6AM - 2PM)</option>
              <option value="Afternoon">Afternoon (2PM - 10PM)</option>
              <option value="Night">Night (10PM - 6AM)</option>
              <option value="Full Time">Full Time</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
            <select id="status" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500">
              <option value="Active">Active</option>
              <option value="On Leave">On Leave</option>
              <option value="Inactive">Inactive</option>
            </select>
          </div>
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
          <textarea id="address" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500"></textarea>
        </div>
        
        <div class="flex justify-end space-x-2">
          <button type="button" onclick="closeModal()" class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50">
            Cancel
          </button>
          <button type="submit" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600">
            <span id="submitText">Add Staff Member</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteModal" class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-50">
    <div class="bg-white rounded-xl p-6 w-full max-w-sm mx-4 fade-in">
      <div class="text-center">
        <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4">
          <i class="fas fa-exclamation-triangle text-red-600"></i>
        </div>
        <h3 class="text-lg font-medium text-gray-900 mb-2">Remove Staff Member</h3>
        <p class="text-sm text-gray-500 mb-4">Are you sure you want to remove this staff member? This action cannot be undone.</p>
        <div class="flex justify-center space-x-2">
          <button onclick="closeDeleteModal()" class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50">
            Cancel
          </button>
          <button onclick="confirmDelete()" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">
            Remove
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Staff management data
    let staffMembers = [
      {
        id: 1,
        firstName: "Ahmad",
        lastName: "Rahman",
        email: "ahmad.rahman@nescafehub.com",
        phone: "+60123456789",
        position: "Head Barista",
        department: "Barista",
        hireDate: "2023-01-15",
        salary: 3500.00,
        shift: "Morning",
        status: "Active",
        address: "123 Jalan Bukit Bintang, Kuala Lumpur"
      },
      {
        id: 2,
        firstName: "Siti",
        lastName: "Aminah",
        email: "siti.aminah@nescafehub.com",
        phone: "+60187654321",
        position: "Senior Cashier",
        department: "Cashier",
        hireDate: "2023-03-20",
        salary: 2800.00,
        shift: "Afternoon",
        status: "Active",
        address: "456 Jalan Ampang, Kuala Lumpur"
      },
      {
        id: 3,
        firstName: "Raj",
        lastName: "Kumar",
        email: "raj.kumar@nescafehub.com",
        phone: "+60112345678",
        position: "Kitchen Assistant",
        department: "Kitchen",
        hireDate: "2023-05-10",
        salary: 2200.00,
        shift: "Morning",
        status: "On Leave",
        address: "789 Jalan Petaling, Kuala Lumpur"
      },
      {
        id: 4,
        firstName: "Michelle",
        lastName: "Tan",
        email: "michelle.tan@nescafehub.com",
        phone: "+60198765432",
        position: "Store Manager",
        department: "Management",
        hireDate: "2022-08-01",
        salary: 5000.00,
        shift: "Full Time",
        status: "Active",
        address: "321 Jalan Tun Razak, Kuala Lumpur"
      }
    ];

    let editingId = null;
    let deleteId = null;
    let currentView = 'card';

    // Initialize the application
    document.addEventListener('DOMContentLoaded', function() {
      loadStaffMembers();
      updateStats();
      populateDepartmentFilter();
      setupEventListeners();
    });

    function setupEventListeners() {
      document.getElementById('searchInput').addEventListener('input', filterStaff);
      document.getElementById('departmentFilter').addEventListener('change', filterStaff);
    }

    function loadStaffMembers() {
      if (currentView === 'card') {
        loadCardView();
      } else {
        loadTableView();
      }
    }

    function loadCardView() {
      const container = document.getElementById('cardView');
      container.innerHTML = '';

      staffMembers.forEach(staff => {
        const card = createStaffCard(staff);
        container.appendChild(card);
      });
    }

    function loadTableView() {
      const tbody = document.getElementById('staff-table');
      tbody.innerHTML = '';

      staffMembers.forEach(staff => {
        const row = createStaffRow(staff);
        tbody.appendChild(row);
      });
    }

    function createStaffCard(staff) {
      const card = document.createElement('div');
      card.className = 'employee-card bg-white rounded-xl shadow-sm p-6 border border-gray-200';
      
      const statusColor = staff.status === 'Active' ? 'bg-green-100 text-green-800' : 
                         staff.status === 'On Leave' ? 'bg-yellow-100 text-yellow-800' : 
                         'bg-red-100 text-red-800';

      const shiftIcon = getShiftIcon(staff.shift);

      card.innerHTML = `
        <div class="flex items-start justify-between mb-4">
          <div class="flex items-center">
            <div class="w-12 h-12 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center text-white font-bold text-lg">
              ${staff.firstName.charAt(0)}${staff.lastName.charAt(0)}
            </div>
            <div class="ml-3">
              <h3 class="font-semibold text-gray-900">${staff.firstName} ${staff.lastName}</h3>
              <p class="text-sm text-gray-600">${staff.position}</p>
            </div>
          </div>
          <span class="px-2 py-1 text-xs font-medium rounded-full ${statusColor}">${staff.status}</span>
        </div>
        
        <div class="space-y-2 mb-4">
          <div class="flex items-center text-sm text-gray-600">
            <i class="fas fa-building w-4"></i>
            <span class="ml-2">${staff.department}</span>
          </div>
          <div class="flex items-center text-sm text-gray-600">
            <i class="${shiftIcon} w-4"></i>
            <span class="ml-2">${staff.shift}</span>
          </div>
          <div class="flex items-center text-sm text-gray-600">
            <i class="fas fa-envelope w-4"></i>
            <span class="ml-2">${staff.email}</span>
          </div>
          <div class="flex items-center text-sm text-gray-600">
            <i class="fas fa-phone w-4"></i>
            <span class="ml-2">${staff.phone}</span>
          </div>
          <div class="flex items-center text-sm text-gray-600">
            <i class="fas fa-money-bill-wave w-4"></i>
            <span class="ml-2">RM ${staff.salary.toFixed(2)}</span>
          </div>
        </div>
        
        <div class="flex justify-between items-center pt-4 border-t border-gray-200">
          <span class="text-sm text-gray-500">Hired: ${formatDate(staff.hireDate)}</span>
          <div class="flex space-x-2">
            <button onclick="editStaff(${staff.id})" class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition">
              <i class="fas fa-edit"></i>
            </button>
            <button onclick="deleteStaff(${staff.id})" class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        </div>
      `;

      return card;
    }

    function createStaffRow(staff) {
      const row = document.createElement('tr');
      row.className = 'hover:bg-gray-50';
      
      const statusColor = staff.status === 'Active' ? 'bg-green-100 text-green-800' : 
                         staff.status === 'On Leave' ? 'bg-yellow-100 text-yellow-800' : 
                         'bg-red-100 text-red-800';

      row.innerHTML = `
        <td class="px-6 py-4 whitespace-nowrap">
          <div class="flex items-center">
            <div class="w-10 h-10 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center text-white font-bold">
              ${staff.firstName.charAt(0)}${staff.lastName.charAt(0)}
            </div>
            <div class="ml-4">
              <div class="font-medium text-gray-900">${staff.firstName} ${staff.lastName}</div>
              <div class="text-sm text-gray-500">${staff.email}</div>
            </div>
          </div>
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${staff.position}</td>
        <td class="px-6 py-4 whitespace-nowrap">
          <span class="px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full">${staff.department}</span>
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatDate(staff.hireDate)}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">RM ${staff.salary.toFixed(2)}</td>
        <td class="px-6 py-4 whitespace-nowrap">
          <span class="px-2 py-1 text-xs font-medium rounded-full ${statusColor}">${staff.status}</span>
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
          <button onclick="editStaff(${staff.id})" class="text-indigo-600 hover:text-indigo-900 mr-2">
            <i class="fas fa-edit"></i>
          </button>
          <button onclick="deleteStaff(${staff.id})" class="text-red-600 hover:text-red-900">
            <i class="fas fa-trash"></i>
          </button>
        </td>
      `;

      return row;
    }

    function getShiftIcon(shift) {
      switch(shift) {
        case 'Morning': return 'fas fa-sun';
        case 'Afternoon': return 'fas fa-cloud-sun';
        case 'Night': return 'fas fa-moon';
        default: return 'fas fa-clock';
      }
    }

    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric' 
      });
    }

    function updateStats() {
      const totalStaff = staffMembers.length;
      const activeStaff = staffMembers.filter(staff => staff.status === 'Active').length;
      const onShiftStaff = staffMembers.filter(staff => 
        staff.status === 'Active' && (staff.shift === 'Morning' || staff.shift === 'Afternoon')
      ).length;

      document.getElementById('totalStaff').textContent = totalStaff;
      document.getElementById('activeStaff').textContent = activeStaff;
      document.getElementById('onShiftStaff').textContent = onShiftStaff;
    }

    function populateDepartmentFilter() {
      const departments = [...new Set(staffMembers.map(staff => staff.department))];
      const select = document.getElementById('departmentFilter');
      
      // Clear existing options except "All Departments"
      select.innerHTML = '<option value="">All Departments</option>';
      
      departments.forEach(department => {
        const option = document.createElement('option');
        option.value = department;
        option.textContent = department;
        select.appendChild(option);
      });
    }

    function filterStaff() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const departmentFilter = document.getElementById('departmentFilter').value;
      
      const filteredStaff = staffMembers.filter(staff => {
        const matchesSearch = staff.firstName.toLowerCase().includes(searchTerm) || 
                            staff.lastName.toLowerCase().includes(searchTerm) ||
                            staff.email.toLowerCase().includes(searchTerm) ||
                            staff.position.toLowerCase().includes(searchTerm);
        const matchesDepartment = !departmentFilter || staff.department === departmentFilter;
        return matchesSearch && matchesDepartment;
      });

      if (currentView === 'card') {
        const container = document.getElementById('cardView');
        container.innerHTML = '';
        filteredStaff.forEach(staff => {
          const card = createStaffCard(staff);
          container.appendChild(card);
        });
      } else {
        const tbody = document.getElementById('staff-table');
        tbody.innerHTML = '';
        filteredStaff.forEach(staff => {
          const row = createStaffRow(staff);
          tbody.appendChild(row);
        });
      }
    }

    function sortStaff() {
      const sortBy = document.getElementById('sortBy').value;
      
      staffMembers.sort((a, b) => {
        switch(sortBy) {
          case 'name':
            return (a.firstName + ' ' + a.lastName).localeCompare(b.firstName + ' ' + b.lastName);
          case 'department':
            return a.department.localeCompare(b.department);
          case 'hireDate':
            return new Date(a.hireDate) - new Date(b.hireDate);
          case 'salary':
            return b.salary - a.salary;
          default:
            return 0;
        }
      });
      
      loadStaffMembers();
    }

    function switchView(view) {
      currentView = view;
      
      if (view === 'card') {
        document.getElementById('cardView').style.display = 'grid';
        document.getElementById('tableView').style.display = 'none';
        document.getElementById('cardViewBtn').className = 'px-4 py-2 rounded-md bg-white shadow-sm text-sm font-medium';
        document.getElementById('tableViewBtn').className = 'px-4 py-2 rounded-md text-sm font-medium text-gray-600';
      } else {
        document.getElementById('cardView').style.display = 'none';
        document.getElementById('tableView').style.display = 'block';
        document.getElementById('cardViewBtn').className = 'px-4 py-2 rounded-md text-sm font-medium text-gray-600';
        document.getElementById('tableViewBtn').className = 'px-4 py-2 rounded-md bg-white shadow-sm text-sm font-medium';
      }
      
      loadStaffMembers();
    }

    // CRUD Operations
    function openAddModal() {
      editingId = null;
      document.getElementById('modalTitle').textContent = 'Add New Staff Member';
      document.getElementById('submitText').textContent = 'Add Staff Member';
      document.getElementById('staffForm').reset();
      document.getElementById('staffModal').classList.add('active');
    }

    function editStaff(id) {
      const staff = staffMembers.find(staff => staff.id === id);
      if (!staff) return;

      editingId = id;
      document.getElementById('modalTitle').textContent = 'Edit Staff Member';
      document.getElementById('submitText').textContent = 'Update Staff Member';
      
      document.getElementById('firstName').value = staff.firstName;
      document.getElementById('lastName').value = staff.lastName;
      document.getElementById('email').value = staff.email;
      document.getElementById('phone').value = staff.phone;
      document.getElementById('position').value = staff.position;
      document.getElementById('department').value = staff.department;
      document.getElementById('hireDate').value = staff.hireDate;
      document.getElementById('salary').value = staff.salary;
      document.getElementById('shift').value = staff.shift;
      document.getElementById('status').value = staff.status;
      document.getElementById('address').value = staff.address;
      
      document.getElementById('staffModal').classList.add('active');
    }

    function deleteStaff(id) {
      deleteId = id;
      document.getElementById('deleteModal').classList.add('active');
    }

    function handleSubmit(event) {
      event.preventDefault();
      
      const formData = {
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        position: document.getElementById('position').value,
        department: document.getElementById('department').value,
        hireDate: document.getElementById('hireDate').value,
        salary: parseFloat(document.getElementById('salary').value),
        shift: document.getElementById('shift').value,
        status: document.getElementById('status').value,
        address: document.getElementById('address').value
      };

      if (editingId) {
        // Update existing staff
        const index = staffMembers.findIndex(staff => staff.id === editingId);
        staffMembers[index] = { ...staffMembers[index], ...formData };
      } else {
        // Add new staff
        const newId = Math.max(...staffMembers.map(staff => staff.id)) + 1;
        staffMembers.push({ id: newId, ...formData });
      }

      loadStaffMembers();
      updateStats();
      populateDepartmentFilter();
      closeModal();
    }

    function confirmDelete() {
      staffMembers = staffMembers.filter(staff => staff.id !== deleteId);
      loadStaffMembers();
      updateStats();
      populateDepartmentFilter();
      closeDeleteModal();
    }

    function closeModal() {
      document.getElementById('staffModal').classList.remove('active');
    }

    function closeDeleteModal() {
      document.getElementById('deleteModal').classList.remove('active');
      deleteId = null;
    }

    function exportStaffData() {
      const csvContent = "data:text/csv;charset=utf-8," + 
        "First Name,Last Name,Email,Phone,Position,Department,Hire Date,Salary,Shift,Status,Address\n" +
        staffMembers.map(staff => 
          `"${staff.firstName}","${staff.lastName}","${staff.email}","${staff.phone}","${staff.position}","${staff.department}","${staff.hireDate}",${staff.salary},"${staff.shift}","${staff.status}","${staff.address}"`
        ).join("\n");

      const encodedUri = encodeURI(csvContent);
      const link = document.createElement("a");
      link.setAttribute("href", encodedUri);
      link.setAttribute("download", "staff_directory.csv");
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    </script>